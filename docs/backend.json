{
  "entities": {
    "Patient": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Patient",
      "type": "object",
      "description": "Represents a patient in the system, with a user account.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Patient entity (matches user UID)."
        },
        "firstName": {
          "type": "string",
          "description": "Patient's first name."
        },
        "lastName": {
          "type": "string",
          "description": "Patient's last name."
        },
        "dateOfBirth": {
          "type": "string",
          "description": "Patient's date of birth.",
          "format": "date-time"
        },
        "gender": {
          "type": "string",
          "description": "Patient's gender."
        },
        "contactNumber": {
          "type": "string",
          "description": "Patient's contact phone number."
        },
        "email": {
          "type": "string",
          "description": "Patient's email address.",
          "format": "email"
        },
        "address": {
          "type": "string",
          "description": "Patient's address."
        },
        "role": {
          "type": "string",
          "description": "The role of the user.",
          "enum": ["patient"]
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "dateOfBirth",
        "gender",
        "contactNumber",
        "email",
        "address",
        "role"
      ]
    },
    "Doctor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Doctor",
      "type": "object",
      "description": "Represents a doctor in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Doctor entity (matches user UID)."
        },
        "firstName": {
          "type": "string",
          "description": "Doctor's first name."
        },
        "lastName": {
          "type": "string",
          "description": "Doctor's last name."
        },
        "specialization": {
          "type": "string",
          "description": "Doctor's specialization."
        },
        "contactNumber": {
          "type": "string",
          "description": "Doctor's contact phone number."
        },
        "email": {
          "type": "string",
          "description": "Doctor's email address.",
          "format": "email"
        },
        "hospitalId": {
          "type": "string",
          "description": "Reference to Hospital. (Relationship: Hospital 1:N Doctor)"
        },
        "role": {
          "type": "string",
          "description": "The role of the doctor within the hospital.",
          "enum": ["doctor", "head_doctor"]
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "specialization",
        "contactNumber",
        "email",
        "hospitalId",
        "role"
      ]
    },
    "Pharmacist": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Pharmacist",
      "type": "object",
      "description": "Represents a pharmacist user in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Pharmacist entity (matches user UID)."
        },
        "firstName": {
          "type": "string",
          "description": "Pharmacist's first name."
        },
        "lastName": {
          "type": "string",
          "description": "Pharmacist's last name."
        },
        "pharmacyId": {
          "type": "string",
          "description": "Reference to Pharmacy. (Relationship: Pharmacy 1:N Pharmacist)"
        },
        "email": {
          "type": "string",
          "description": "Pharmacist's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The role of the pharmacist.",
          "enum": ["head_pharmacist", "employee"]
        }
      },
      "required": ["id", "firstName", "lastName", "pharmacyId", "email", "role"]
    },
    "Admin": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Admin",
      "type": "object",
      "description": "Represents a site admin user in the system for content management.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Admin entity (matches user UID)."
        },
        "email": {
          "type": "string",
          "description": "Admin's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The role of the user.",
          "enum": ["admin"]
        }
      },
      "required": ["id", "email", "role"]
    },
     "SystemAdmin": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SystemAdmin",
      "type": "object",
      "description": "Represents a system admin with highest privileges.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the System Admin (matches user UID)."
        },
        "email": {
          "type": "string",
          "description": "System Admin's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The role of the user.",
          "enum": ["system_admin"]
        }
      },
      "required": ["id", "email", "role"]
    },
    "Hospital": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Hospital",
      "type": "object",
      "description": "Represents a hospital in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Hospital entity."
        },
        "name": {
          "type": "string",
          "description": "Hospital's name."
        },
        "address": {
          "type": "string",
          "description": "Hospital's address."
        },
        "contactNumber": {
          "type": "string",
          "description": "Hospital's contact phone number."
        },
        "email": {
          "type": "string",
          "description": "Hospital's email address.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "name",
        "address",
        "contactNumber",
        "email"
      ]
    },
    "Pharmacy": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Pharmacy",
      "type": "object",
      "description": "Represents a pharmacy in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Pharmacy entity."
        },
        "name": {
          "type": "string",
          "description": "Pharmacy's name."
        },
        "address": {
          "type": "string",
          "description": "Pharmacy's address."
        },
        "contactNumber": {
          "type": "string",
          "description": "Pharmacy's contact phone number."
        },
        "email": {
          "type": "string",
          "description": "Pharmacy's email address.",
          "format": "email"
        },
        "latitude": {
            "type": "number",
            "description": "Geographical latitude of the pharmacy."
        },
        "longitude": {
            "type": "number",
            "description": "Geographical longitude of the pharmacy."
        }
      },
      "required": [
        "id",
        "name",
        "address",
        "contactNumber",
        "email",
        "latitude",
        "longitude"
      ]
    },
    "Medication": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Medication",
      "type": "object",
      "description": "Represents a medication in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Medication entity."
        },
        "name": {
          "type": "string",
          "description": "Medication's name."
        },
        "dosage": {
          "type": "string",
          "description": "Medication's dosage."
        },
        "unit": {
          "type": "string",
          "description": "Unit of measurement for the medication (e.g., mg, ml)."
        },
        "form": {
          "type": "string",
          "description": "Medication's form (e.g., tablet, capsule, liquid)."
        }
      },
      "required": [
        "id",
        "name",
        "dosage",
        "unit",
        "form"
      ]
    },
    "Prescription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Prescription",
      "type": "object",
      "description": "Represents a prescription in the system, which can contain multiple medications.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the Prescription entity." },
        "patientId": { "type": "string", "description": "Reference to Patient." },
        "patientName": { "type": "string", "description": "Denormalized patient name for display." },
        "doctorId": { "type": "string", "description": "Reference to Doctor." },
        "hospitalId": { "type": "string", "description": "Denormalized hospital ID for easier queries." },
        "pharmacyId": { "type": "string", "description": "Reference to the designated Pharmacy." },
        "datePrescribed": { "type": "string", "format": "date-time", "description": "Date the prescription was prescribed." },
        "verificationCode": { "type": "string", "description": "Verification code for prescription fulfillment." },
        "complaint": { "type": "string", "description": "The patient's primary complaint." },
        "diagnosis": { "type": "string", "description": "The diagnosis determined by the doctor." },
        "medications": {
          "type": "array",
          "description": "List of prescribed medications.",
          "items": {
            "$ref": "#/entities/PrescribedMedication"
          }
        },
        "totalCost": {
            "type": "number",
            "description": "Total cost of the medications in the prescription."
        },
        "paymentReceived": {
            "type": "number",
            "description": "Amount paid by the patient."
        }
      },
      "required": [ "id", "patientId", "doctorId", "datePrescribed", "diagnosis", "medications" ]
    },
    "PrescribedMedication": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PrescribedMedication",
      "type": "object",
      "description": "Represents a single medication within a prescription.",
      "properties": {
          "medicationName": { "type": "string", "description": "Name of the medication." },
          "dosage": { "type": "string", "description": "Dosage of the medication." },
          "instructions": { "type": "string", "description": "Instructions for taking the medication." }
      },
      "required": [ "medicationName", "dosage", "instructions" ]
    },
    "Inventory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Inventory",
      "type": "object",
      "description": "Represents the inventory of a pharmacy.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Inventory entity."
        },
        "pharmacyId": {
          "type": "string",
          "description": "Reference to Pharmacy. (Relationship: Pharmacy 1:N Inventory)"
        },
        "name": {
          "type": "string",
          "description": "Medication's name."
        },
        "dosage": {
          "type": "string",
          "description": "Medication's dosage."
        },
        "unit": {
          "type": "string",
          "description": "Unit of measurement."
        },
        "form": {
          "type": "string",
          "description": "Medication's form."
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the medication in stock."
        },
        "expirationDate": {
          "type": "string",
          "description": "Expiration date of the medication.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "pharmacyId",
        "name",
        "dosage",
        "unit",
        "form",
        "quantity",
        "expirationDate"
      ]
    },
    "SupportingOrganization": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SupportingOrganization",
      "type": "object",
      "description": "Represents an organization that supports the ReseptPlus project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Supporting Organization entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the supporting organization."
        },
        "description": {
          "type": "string",
          "description": "A short description of the organization's support."
        },
        "logoUrl": {
          "type": "string",
          "description": "URL of the organization's logo."
        }
      },
      "required": ["id", "name", "description", "logoUrl"]
    },
    "ClientCompany": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ClientCompany",
      "type": "object",
      "description": "Represents a client company using the ReseptPlus platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Client Company entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the client company."
        },
        "description": {
          "type": "string",
          "description": "A short description of the company."
        },
        "logoUrl": {
          "type": "string",
          "description": "URL of the company's logo."
        }
      },
      "required": ["id", "name", "description", "logoUrl"]
    },
    "BlogPost": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BlogPost",
      "type": "object",
      "description": "Represents a blog post on the marketing site.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Blog Post entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the blog post."
        },
        "description": {
          "type": "string",
          "description": "A short summary or description of the blog post."
        },
        "content": {
          "type": "string",
          "description": "The full content of the blog post, likely in Markdown format."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL for the main image of the blog post."
        },
        "imageHint": {
          "type": "string",
          "description": "A hint for AI to find a relevant image."
        },
        "author": {
          "type": "string",
          "description": "The name of the post's author."
        },
        "datePublished": {
          "type": "string",
          "format": "date-time",
          "description": "The date the blog post was published."
        }
      },
      "required": ["id", "title", "description", "content", "author", "datePublished", "imageUrl"]
    },
     "PricingPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PricingPlan",
      "type": "object",
      "description": "Represents a pricing plan for the ReseptPlus service.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Pricing Plan entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the pricing plan."
        },
        "description": {
          "type": "string",
          "description": "A short description of the plan."
        },
        "price": {
          "type": "string",
          "description": "The price of the plan, can be a number or 'Custom'."
        },
        "period": {
          "type": "string",
          "description": "The billing period, e.g., '/ay'."
        },
        "features": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "A list of features included in the plan."
        },
        "isPopular": {
          "type": "boolean",
          "description": "Whether the plan is marked as popular."
        }
      },
      "required": ["id", "title", "description", "price", "features", "isPopular"]
    },
    "ProductFeature": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProductFeature",
      "type": "object",
      "description": "Represents a feature of the product, displayed on the marketing site.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Product Feature entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the feature."
        },
        "description": {
          "type": "string",
          "description": "A short description of the feature."
        },
        "icon": {
          "type": "string",
          "description": "The name of the lucide-react icon to display for the feature."
        }
      },
      "required": ["id", "title", "description", "icon"]
    },
    "TeamMember": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TeamMember",
      "type": "object",
      "description": "Represents a team member of the ReseptPlus project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Team Member entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the team member."
        },
        "role": {
          "type": "string",
          "description": "The role or title of the team member."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the team member's avatar/photo."
        },
        "imageHint": {
          "type": "string",
          "description": "A hint for AI to find a relevant image for the team member."
        }
      },
      "required": ["id", "name", "role", "imageUrl"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/patients/{patientId}",
        "definition": {
          "entityName": "Patient",
          "schema": {
            "$ref": "#/entities/Patient"
          },
          "description": "Stores patient user profiles. Path-based ownership ensures only the authenticated user can access their own profile data.",
          "params": [
            {
              "name": "patientId",
              "description": "The unique identifier for the patient (matches user UID)."
            }
          ]
        }
      },
      {
        "path": "/doctors/{doctorId}",
        "definition": {
          "entityName": "Doctor",
          "schema": {
            "$ref": "#/entities/Doctor"
          },
          "description": "Stores doctor user profiles. Accessible to authorized personnel.",
          "params": [
            {
              "name": "doctorId",
              "description": "The unique identifier for the doctor (matches user UID)."
            }
          ]
        }
      },
      {
        "path": "/pharmacists/{pharmacistId}",
        "definition": {
          "entityName": "Pharmacist",
          "schema": {
            "$ref": "#/entities/Pharmacist"
          },
          "description": "Stores pharmacist user profiles. Accessible to authorized personnel.",
          "params": [
            {
              "name": "pharmacistId",
              "description": "The unique identifier for the pharmacist (matches user UID)."
            }
          ]
        }
      },
      {
        "path": "/admins/{adminId}",
        "definition": {
          "entityName": "Admin",
          "schema": {
            "$ref": "#/entities/Admin"
          },
          "description": "Stores site admin user profiles. Only accessible by system admins.",
          "params": [
            {
              "name": "adminId",
              "description": "The unique identifier for the site admin user."
            }
          ]
        }
      },
      {
        "path": "/systemAdmins/{adminId}",
        "definition": {
          "entityName": "SystemAdmin",
          "schema": {
            "$ref": "#/entities/SystemAdmin"
          },
          "description": "Stores system admin user profiles with the highest privileges.",
          "params": [
            {
              "name": "adminId",
              "description": "The unique identifier for the system admin user."
            }
          ]
        }
      },
      {
        "path": "/hospitals/{hospitalId}",
        "definition": {
          "entityName": "Hospital",
          "schema": {
            "$ref": "#/entities/Hospital"
          },
          "description": "Stores hospital information. Writable by system admins.",
          "params": [
            {
              "name": "hospitalId",
              "description": "The unique identifier for the hospital."
            }
          ]
        }
      },
      {
        "path": "/pharmacies/{pharmacyId}",
        "definition": {
          "entityName": "Pharmacy",
          "schema": {
            "$ref": "#/entities/Pharmacy"
          },
          "description": "Stores pharmacy information. Writable by system admins.",
          "params": [
            {
              "name": "pharmacyId",
              "description": "The unique identifier for the pharmacy."
            }
          ]
        }
      },
      {
        "path": "/medications/{medicationId}",
        "definition": {
          "entityName": "Medication",
          "schema": {
            "$ref": "#/entities/Medication"
          },
          "description": "Stores medication details. Publicly accessible, writable by admins.",
          "params": [
            {
              "name": "medicationId",
              "description": "The unique identifier for the medication."
            }
          ]
        }
      },
      {
        "path": "/prescriptions/{prescriptionId}",
        "definition": {
          "entityName": "Prescription",
          "schema": {
            "$ref": "#/entities/Prescription"
          },
          "description": "Stores prescription data. Accessible to the patient, doctor, and pharmacy involved.",
          "params": [
            {
              "name": "prescriptionId",
              "description": "The unique identifier for the prescription."
            }
          ]
        }
      },
      {
        "path": "/pharmacies/{pharmacyId}/inventory/{inventoryId}",
        "definition": {
          "entityName": "Inventory",
          "schema": {
            "$ref": "#/entities/Inventory"
          },
          "description": "Stores inventory for a specific pharmacy. Writable by the pharmacy's head pharmacist.",
          "params": [
            {
              "name": "pharmacyId",
              "description": "The unique identifier for the pharmacy."
            },
            {
              "name": "inventoryId",
              "description": "The unique identifier for the inventory item."
            }
          ]
        }
      },
      {
        "path": "/supportingOrganizations/{orgId}",
        "definition": {
          "entityName": "SupportingOrganization",
          "schema": {
            "$ref": "#/entities/SupportingOrganization"
          },
          "description": "Publicly readable, admin writable.",
          "params": [
            {
              "name": "orgId",
              "description": "The unique identifier for the supporting organization."
            }
          ]
        }
      },
      {
        "path": "/clientCompanies/{companyId}",
        "definition": {
          "entityName": "ClientCompany",
          "schema": {
            "$ref": "#/entities/ClientCompany"
          },
          "description": "Publicly readable, admin writable.",
          "params": [
            {
              "name": "companyId",
              "description": "The unique identifier for the client company."
            }
          ]
        }
      },
      {
        "path": "/blogPosts/{postId}",
        "definition": {
          "entityName": "BlogPost",
          "schema": {
            "$ref": "#/entities/BlogPost"
          },
          "description": "Publicly readable, admin writable.",
          "params": [
            {
              "name": "postId",
              "description": "The unique identifier for the blog post."
            }
          ]
        }
      },
      {
        "path": "/pricingPlans/{planId}",
        "definition": {
          "entityName": "PricingPlan",
          "schema": {
            "$ref": "#/entities/PricingPlan"
          },
          "description": "Publicly readable, admin writable.",
          "params": [
            {
              "name": "planId",
              "description": "The unique identifier for the pricing plan."
            }
          ]
        }
      },
      {
        "path": "/productFeatures/{featureId}",
        "definition": {
          "entityName": "ProductFeature",
          "schema": {
            "$ref": "#/entities/ProductFeature"
          },
          "description": "Publicly readable, admin writable.",
          "params": [
            {
              "name": "featureId",
              "description": "The unique identifier for the product feature."
            }
          ]
        }
      },
       {
        "path": "/teamMembers/{memberId}",
        "definition": {
          "entityName": "TeamMember",
          "schema": {
            "$ref": "#/entities/TeamMember"
          },
          "description": "Publicly readable, admin writable.",
          "params": [
            {
              "name": "memberId",
              "description": "The unique identifier for the team member."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is updated to support multiple user roles (Patient, Doctor, Pharmacist, Admin, SystemAdmin). Each user role has its own top-level collection to enforce role-based access control easily. For instance, `/patients/{patientId}` stores patient data accessible only by the patient themselves, while `/pharmacists/{pharmacistId}` stores pharmacist data. This flat structure simplifies security rules and avoids complex nested reads. Administrative roles are split into 'admin' (for site content) and 'system_admin' (for system-level management) to enforce separation of duties. The Inventory is now a sub-collection of a pharmacy to enforce ownership. This design ensures a secure, scalable, and maintainable data architecture."
  }
}
    